# Graph Documentation - Unsupervised IDS Pipeline

This document explains every visualization generated by `src/evaluate_models.py`. All plots are saved inside each run directory under `outputs/<run_id>/plots/`.

---

## 1. `isolation_forest_analysis.png`
**Purpose:** Inspect how the Isolation Forest model scores flows and identify top anomalies.

**Panels:**
1. **Anomaly Score Distribution** – Histogram of Isolation Forest scores (lower = more anomalous). The red dashed line marks the 10th percentile threshold often used to flag suspicious flows.
2. **Anomaly vs Normal Pie Chart** – Percentage of flows flagged as anomalies (-1) versus normal (+1).
3. **Score vs Prediction Scatter** – Scores plotted in sequence; highlights how anomalous flows cluster at lower scores.
4. **Top 100 Anomalies** – Horizontal bar chart of the lowest scores, useful for inspecting the most suspicious flows.

**Talking Points:** Explains model sensitivity, threshold selection, and volume of anomalies detected.

---

## 2. `kmeans_analysis.png`
**Purpose:** Understand clustering structure discovered by K-Means.

**Panels:**
1. **Cluster Size Distribution** – Number of flows in each cluster (shows dominance or rarity).
2. **PCA Visualization** – First two principal components colored by cluster to illustrate separation.
3. **t-SNE Visualization** – Non-linear embedding (auto-skipped if dataset > 5k points) showing cluster separation.
4. **Cluster Feature Heatmap** – Mean values of top features per cluster (helps interpret what each cluster represents).

**Talking Points:** Patterns in traffic behavior, distinct clusters that may correspond to benign vs attack behaviors.

---

## 3. `autoencoder_analysis.png`
**Purpose:** Evaluate reconstruction-based anomaly detection.

**Panels:**
1. **Reconstruction Error Histogram** – Distribution with red threshold (95th percentile).
2. **Anomaly vs Normal Pie Chart** – Share of flows above threshold (flagged anomalies).
3. **Error Scatter** – Errors by index, contrasting normals vs anomalies.
4. **Top 100 Anomalies** – Highest reconstruction errors for inspection.

**Talking Points:** Explains how autoencoder learns “normal” behavior; high errors indicate novel/attack flows.

---

## 4. `model_agreement.png`
**Purpose:** Compare Isolation Forest, Autoencoder, and K-Means outputs.

**Panels:**
1. **Agreement Bar Chart** – Counts of flows flagged by both models vs only one vs neither.
2. **Correlation Matrix** – Correlation between IF anomaly flag, AE anomaly flag, and K-Means cluster ID.
3. **Agreement Statistics** – Text summary with precise counts and percentages.
4. **Cluster vs Anomaly Rate** – Breakdown of anomaly percentage per K-Means cluster.

**Talking Points:** Shows ensemble behavior, consensus anomalies, and which clusters are riskier.

---

## 5. `feature_importance.png`
**Purpose:** Highlight which flow features contribute most to Isolation Forest decisions.

**Content:** Top 20 features ranked by importance (based on Isolation Forest feature_importances_). Typical features: bytes, packets, duration, protocol indicators.

**Talking Points:** Provides interpretability—helps justify why the model flags certain flows.

---

## 6. `feature_distributions.png`
**Purpose:** Compare feature distributions between normal and anomalous flows.

**Content:** KDE plots for the top 4–6 influential features (e.g., packet count, byte rate). Green = normal, red = anomalies.

**Talking Points:** Easy to show how anomalies deviate (e.g., extremely high bytes, unusual ratios).

---

## 7. `if_vs_ae_scores.png`
**Purpose:** Show relationship between Isolation Forest scores and Autoencoder errors.

**Content:** Scatter plot (color-coded by IF anomaly flag) with IF score on X-axis and AE reconstruction error on Y-axis.

**Talking Points:** Demonstrates agreement/disagreement between models and helps define combined thresholds.

---

### Suggested Presentation Flow
1. Start with **Isolation Forest** and **Autoencoder** analyses to explain anomaly detection.
2. Use **Feature Importance** + **Feature Distributions** to interpret what “anomaly” means in network terms.
3. Highlight **K-Means** plots to show clustering context (normal vs attack patterns).
4. Finish with **Model Agreement** and **IF vs AE Scores** to discuss ensemble insights and next steps.


